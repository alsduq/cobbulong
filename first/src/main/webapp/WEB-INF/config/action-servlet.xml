<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:context="http://www.springframework.org/schema/context"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:websocket="http://www.springframework.org/schema/websocket"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
						http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
						http://www.springframework.org/schema/tx
						http://www.springframework.org/schema/tx/spring-tx.xsd
						http://www.springframework.org/schema/websocket
						http://www.springframework.org/schema/websocket/spring-websocket-4.1.xsd">

	<context:component-scan base-package="first"></context:component-scan>
	
	<mvc:annotation-driven>
		<mvc:argument-resolvers>
			<bean class="first.common.resolver.CustomMapArgumentResolver"></bean>		
		</mvc:argument-resolvers>
	</mvc:annotation-driven>
	
	<mvc:interceptors>
		<mvc:interceptor>
			<mvc:mapping path="/**"/>
			<bean id="loggerInterceptor" class="first.common.logger.LoggerInterceptor"></bean>
		</mvc:interceptor>
	</mvc:interceptors>
	
    
    <bean class="org.springframework.web.servlet.view.BeanNameViewResolver" p:order="0" />
    <bean id="jsonView" class="org.springframework.web.servlet.view.json.MappingJackson2JsonView" />    
    
    <bean
    	class="org.springframework.web.servlet.view.UrlBasedViewResolver" p:order="1" 
    	p:viewClass="org.springframework.web.servlet.view.JstlView" 
    	p:prefix="/WEB-INF/jsp/" p:suffix=".jsp">
   	</bean>
   	
   	<!-- 트랜잭션 처리 -->
   	<tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/>

   	
   	<!-- websocket -->
   	<websocket:handlers>
   		<websocket:mapping handler="chatHandler" path="/chat.do"/>
   		<websocket:handshake-interceptors>
   			<bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor" />
   		</websocket:handshake-interceptors>
   		<websocket:sockjs/>
   	</websocket:handlers>
	<bean id="chatHandler" class="first.almom.handler.ChatWebSocketHandler"/>
	
	<!-- <websocket:handlers>
        <websocket:mapping path="/websocket/echo.do" handler="myHandler"/>
    </websocket:handlers>
    <bean id="myHandler" class="first.almom.handler.SocketHandler"/> -->

</beans>


